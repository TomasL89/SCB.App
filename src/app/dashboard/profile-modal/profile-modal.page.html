<!-- <ion-toolbar *ngIf="!isComplexEditMode"> -->
<ion-toolbar>
  <ion-icon *ngIf="!isEditMode" name="arrow-back-outline" (click)="dismiss()" class="ion-padding" style="float: left;"></ion-icon>
  <ion-icon *ngIf="isEditMode" name="close" (click)="enableEditMode()" class="ion-padding" style="float: left"></ion-icon>
  <ion-icon *ngIf="isEditMode" name="save-outline" (click)="saveProfile()"  class="ion-padding" style="float: right;"></ion-icon>
  <ion-icon *ngIf="isComplexEditMode && !showProfilePlot" name="analytics-outline" (click)="toggleProfilePlot()"  class="ion-padding" style="float: right;"></ion-icon>
</ion-toolbar>

<ion-content>
  <!-- todo, you can hide all of thise in a better way -->
  <ion-card (click)="enableEditMode()" *ngIf="!isEditMode && !isLibraryMode && !isComplexEditMode">
    <ion-card-content>
      <div class="ion-text-center">
        <p>New Simple Profile <ion-icon name="create-outline" slot="end"></ion-icon> </p>
      </div>
    </ion-card-content>
  </ion-card>
  <!-- <ion-card (click)="enableComplexEditMode()" *ngIf="!isEditMode && !isLibraryMode && !isComplexEditMode">
    <ion-card-content>
      <div class="ion-text-center">
        <p>New Advanced Profile <ion-icon name="color-wand-outline" slot="end"></ion-icon> </p>
      </div>
    </ion-card-content>
  </ion-card> -->
  <ion-card (click)="enableLibraryMode()" *ngIf="!isEditMode && !isLibraryMode && !isComplexEditMode">
    <ion-card-content>
      <div class="ion-text-center">
        Library
        <ion-icon name="library-outline" slot="end"></ion-icon>
      </div>
    </ion-card-content>
  </ion-card>

  <form [formGroup]="complexProfileForm" *ngIf="isComplexEditMode">
        <ion-grid *ngIf="!showProfilePlot" class="ion-no-padding">
              <ion-card>
                <ion-item lines="none">
                  <ion-label  position="stacked">Profile Name</ion-label>
                  <ion-input clearInput formControlName="name" type="text" style="color: gray; font-size: small;" required></ion-input>
                </ion-item>
              </ion-card>
              <ion-card>
                <ion-item lines="none">
                  <ion-label position="stacked">Boiler Temperature</ion-label>
                  <ion-select value=90 #boilerSelect formControlName="boilerTemperature" style="font-size: small;">
                    <ion-select-option value=80>80 °C</ion-select-option>
                    <ion-select-option value=81>81 °C</ion-select-option>
                    <ion-select-option value=82>82 °C</ion-select-option>
                    <ion-select-option value=83>84 °C</ion-select-option>
                    <ion-select-option value=85>85 °C</ion-select-option>
                    <ion-select-option value=86>86 °C</ion-select-option>
                    <ion-select-option value=87>87 °C</ion-select-option>
                    <ion-select-option value=88>88 °C</ion-select-option>
                    <ion-select-option value=89>89 °C</ion-select-option>
                    <ion-select-option value=90>90 °C</ion-select-option>
                    <ion-select-option value=91>91 °C</ion-select-option>
                    <ion-select-option value=92>92 °C</ion-select-option>
                    <ion-select-option value=93>93 °C</ion-select-option>
                    <ion-select-option value=94>94 °C</ion-select-option>
                    <ion-select-option value=95>95 °C</ion-select-option>
                    <ion-select-option value=96>96 °C</ion-select-option>
                    <ion-select-option value=97>97 °C</ion-select-option>
                    <ion-select-option value=98>98 °C</ion-select-option>
                    <ion-select-option value=99>99 °C</ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-card>
              <ion-card>
                <ion-item lines="none">
                  <ion-label position="stacked">Profile Template</ion-label>
                  <ion-select (ionChange)="updateChart($event)" [(ngModel)]="selectedComplexProfile" style="font-size: small;">
                    <ion-select-option *ngFor="let defaultComplexProfile of defaultComplexProfiles" [value]="defaultComplexProfile">
                      {{defaultComplexProfile.name}}
                    </ion-select-option>
                  </ion-select>
                </ion-item>
              </ion-card>
              <!-- <ion-card>
                <ion-item lines="none">
                  <ion-label position="stacked">Preinfusion Start</ion-label>
                  <ion-select value=8 style="font-size: small;" (ionChange)="updatePreinfusionPressure($event)">
                    <ion-select-option value=0>0 Bar</ion-select-option>
                    <ion-select-option value=1>1 Bar</ion-select-option>
                    <ion-select-option value=2>2 Bar</ion-select-option>
                    <ion-select-option value=3>3 Bar</ion-select-option>
                    <ion-select-option value=4>4 Bar</ion-select-option>
                    <ion-select-option value=5>5 Bar</ion-select-option>
                    <ion-select-option value=6>6 Bar</ion-select-option>
                    <ion-select-option value=7>7 Bar</ion-select-option>
                  </ion-select>
                </ion-item>
            </ion-card> -->
             <ion-card>
              <ion-item lines="none">
                <ion-label position="stacked">Baseline Pressure</ion-label>
                <ion-select value=8 placeholder="Select Pressure" style="font-size: small;" [(ngModel)]="baselinePressure">
                  <ion-select-option value=0>0 Bar</ion-select-option>
                  <ion-select-option value=1>1 Bar</ion-select-option>
                  <ion-select-option value=2>2 Bar</ion-select-option>
                  <ion-select-option value=3>3 Bar</ion-select-option>
                  <ion-select-option value=4>4 Bar</ion-select-option>
                  <ion-select-option value=5>5 Bar</ion-select-option>
                  <ion-select-option value=6>6 Bar</ion-select-option>
                  <ion-select-option value=7>7 Bar</ion-select-option>
                  <ion-select-option value=8>8 Bar</ion-select-option>
                  <ion-select-option value=9>9 Bar</ion-select-option>
                  <ion-select-option value=10>10 Bar</ion-select-option>
                  <ion-select-option value=11>11 Bar</ion-select-option>
                  <ion-select-option value=12>12 Bar</ion-select-option>
                </ion-select>
              </ion-item>
            </ion-card>
            <!-- <ion-row>
              <ion-col size="6">
                <ion-item lines="none" class="ion-text-center">
                  <ion-icon name="arrow-back-outline" (click)="dismiss()"></ion-icon>
                </ion-item>
              </ion-col>
              <ion-col size="6">
                <ion-item lines="none" class="ion-text-center">
                  <ion-icon name="analytics-outline" (click)="toggleProfilePlot()"></ion-icon>
                </ion-item>
              </ion-col>
            </ion-row> -->
        </ion-grid>

        <ion-grid *ngIf="showProfilePlot">
          <!-- <ion-row> -->
            <!-- <ion-col size="10"> -->
                <ion-card-content style="height: auto;">
                  <canvas baseChart [datasets]="datasets" [chartType]="'line'" [options]="chartOptions" [labels]="dataLabels"></canvas>
                </ion-card-content>
            <!-- </ion-col> -->
            <!-- <ion-col size="2" style="background-color:teal;">
                <ngx-slider [(value)]="pressureValue" [options]="pressureValueOptions" (userChange)="onPressureChange($event)"></ngx-slider>
              </ion-col> -->
          <!-- </ion-row> -->
          <!-- <ion-row style="height: 10%;">
            <ion-col size="10" style="background-color: pink;">
                <ngx-slider [(value)]="pressureIndex" [options]="pressureIndexOptions" (userChange)="onPressureIndexChange($event)"></ngx-slider>
            </ion-col>
            <ion-col>
              <ion-icon name="arrow-back-outline" (click)="toggleProfilePlot()"></ion-icon>
            </ion-col>
            <ion-col style="background-color: powderblue;">
              <ion-icon name="save-outline"></ion-icon>
            </ion-col>
          </ion-row> -->
        </ion-grid>
  </form>

  <form [formGroup]="profileForm" *ngIf="isEditMode">
    <ion-card style="height: 60px;">
      <ion-item lines="none" class="ion-text-center">
        <ion-label  position="stacked">Profile Name</ion-label>
        <ion-input clearInput formControlName="name" placeholder="New profile" type="text" style="color: gray; font-size: small;" required></ion-input>
      </ion-item>
    </ion-card>
    <ion-card >
      <mat-expansion-panel>
        <mat-expansion-panel-header collapsedHeight="60px">
          <mat-panel-title></mat-panel-title>
          <mat-panel-description style="margin: 0px;">
            <ion-item lines="none" class="ion-text-center">
              <ion-label position="stacked">Boiler Temperature</ion-label>
              <ion-input formControlName="boilerTemperature" value="{{boiler.value}} °C" readonly style="color: gray; font-size: small;"></ion-input>
            </ion-item>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <ion-range min=80 max=100 step=1 #boiler>
          <ion-icon slot="start" size="small" name="thermometer"></ion-icon>
          <ion-icon slot="end" name="thermometer"></ion-icon>
        </ion-range>
      </mat-expansion-panel>
    </ion-card>
    <ion-card >
      <mat-expansion-panel>
        <mat-expansion-panel-header collapsedHeight="60px">
          <mat-panel-title></mat-panel-title>
          <mat-panel-description style="margin: 0px;">
            <ion-item lines="none" class="ion-text-center">
              <ion-label position="stacked">Preinfusion Pressure</ion-label>
              <ion-input formControlName="preinfusionPressure" value="{{preinfusionPressure.value}} Bar" readonly style="color: gray; font-size: small;"></ion-input>
            </ion-item>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <ion-range min=4 max=14 step=1 #preinfusionPressure>
          <ion-icon slot="start"name="remove"></ion-icon>
          <ion-icon slot="end" name="add"></ion-icon>
        </ion-range>
      </mat-expansion-panel>
    </ion-card>
    <ion-card >
      <mat-expansion-panel>
        <mat-expansion-panel-header collapsedHeight="60px">
          <mat-panel-title></mat-panel-title>
          <mat-panel-description style="margin: 0px;">
            <ion-item lines="none" class="ion-text-center">
              <ion-label position="stacked">Preinfusion Time</ion-label>
              <ion-input formControlName="preInfusionTime" value="{{preInfusion.value}} s" readonly style="color: gray; font-size: small;"></ion-input>
            </ion-item>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <ion-range min=0 max=35 step=1 #preInfusion>
          <ion-icon slot="start"name="remove"></ion-icon>
          <ion-icon slot="end" name="add"></ion-icon>
        </ion-range>
      </mat-expansion-panel>
    </ion-card>
    <ion-card >
      <mat-expansion-panel>
        <mat-expansion-panel-header collapsedHeight="60px">
          <mat-panel-title></mat-panel-title>
          <mat-panel-description style="margin: 0px;">
            <ion-item lines="none" class="ion-text-center">
              <ion-label position="stacked">Pump Pressure</ion-label>
              <ion-input formControlName="pumpPressure" value="{{pump.value}} Bar" readonly style="color: gray; font-size: small;"></ion-input>
            </ion-item>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <ion-range min=4 max=14 step=1 #pump>
          <ion-icon slot="start"name="remove"></ion-icon>
          <ion-icon slot="end" name="add"></ion-icon>
        </ion-range>
      </mat-expansion-panel>
    </ion-card>
    <ion-card >
      <mat-expansion-panel>
        <mat-expansion-panel-header collapsedHeight="60px">
          <mat-panel-title></mat-panel-title>
          <mat-panel-description style="margin: 0px;">
            <ion-item lines="none" class="ion-text-center">
              <ion-label position="stacked">Shot Time</ion-label>
              <ion-input formControlName="shotTime" value="{{shot.value}} s" readonly style="color: gray; font-size: small;" required></ion-input>
            </ion-item>
          </mat-panel-description>
        </mat-expansion-panel-header>
          <ion-range min=1 max=60 step=1 #shot>
            <ion-icon slot="start"name="remove"></ion-icon>
            <ion-icon slot="end" name="add"></ion-icon>
          </ion-range>
      </mat-expansion-panel>
    </ion-card>
    <!-- potentially a later feature -->
    <ion-card hidden>
      <mat-expansion-panel>
        <mat-expansion-panel-header collapsedHeight="60px">
          <mat-panel-title style="padding-left: 20%;">
            <ion-item lines="none" class="ion-text-center">
              <ion-label position="stacked">Set as current profile</ion-label>
              <ion-input formControlName="shotTime" value="{{toggle.checked}}" readonly style="color: gray; font-size: small;"></ion-input>
            </ion-item>
          </mat-panel-title>
        </mat-expansion-panel-header>
        <ion-toggle #toggle style="padding-left: 40%;"></ion-toggle>
      </mat-expansion-panel>
    </ion-card>
  </form>

<ion-list *ngIf="isLibraryMode">
  <ion-item-sliding *ngFor="let profile of profiles">
    <ion-item-options side="end">
      <ion-item-option color="dark" (click)="deleteProfile(profile.id)"><ion-icon name="trash" style="color: white;"></ion-icon></ion-item-option>
      <ion-item-option color="light" (click)="editProfile(profile.id)"><ion-icon name="create"></ion-icon></ion-item-option>
    </ion-item-options>
    <ion-item (click)="selectProfile(profile.id)">
      <ion-label>
        <h2>{{profile.name}}</h2>
        <p style="font-size: small;">Boiler {{profile.boilerTemperature}}°C | Pump {{profile.pumpPressure}} Bar | Pre-infusion {{profile.preInfusionTime}} s | Shot {{profile.shotTime}} s</p>
      </ion-label>
    </ion-item>
  </ion-item-sliding>
</ion-list>

</ion-content>
